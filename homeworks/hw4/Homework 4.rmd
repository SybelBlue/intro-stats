---
title: "Homework 4"
author: Logan Caraco
output: 
  html_document:
    toc: true
    toc_float: true
---


\
\


```{r, message=FALSE}
library(ggplot2)
library(dplyr)

library(magrittr)
```

# 1. Cars
Consider the cars data which contains the sales price and other information for used Ford cars in St Paul and Dallas. To begin, we can model the price of a car by its mileage and age (in years) without an interaction:

```{r}
cars <- read.csv("http://www.macalester.edu/~ajohns24/data/FordsSub.csv")
car_model_1 <- lm(Price ~ Mileage + Age, cars)
summary(car_model_1)$coefficients
```

The corresponding model formula corresponds to the plane shown below:
<center>`Price = 15820 - 0.069 Mileage - 480.09 Age`</center>

By not including an interaction term, the above model assumed that the association between price and mileage does not differ by the age of the car. However, this assumption appears to be false. Instead, consider a model that includes an interaction between mileage and age:

```{r}
car_model_2 <- lm(Price ~ Age * Mileage, cars)
summary(car_model_2)$coefficients
```

<center> `Price = 18950 - 1461*Age - 0.122*Mileage  + 0.012 Age*Mileage` </center>

 a. Interpret the intercept coefficient, 18950. (This actually makes sense in this model!)
 
 *A brand new car (Age, Mileage = 0) has a starting price of $18,950.*

 b. Use car_model_2 to predict the price of a 5 year old car that has 10,000 miles on it.

```{r}
predict(car_model_2, newdata = data.frame(Age = 5, Mileage = 1e5))
```

# 2. Car interactions

By including an interaction term, `car_model_2` assumes that the association between price and mileage may differ depending on the age of the car. Let’s explore what this means in practice.

 a. Use `car_model_2` to construct formulas for the relationships between price and mileage for cars of different ages. Each of these should be of the form `Price = a + b Mileage` where you specify `a` and `b`. The first one is done for you. Complete the others using a similar technique.

* 1 year old cars 

$$\begin{align} Price &=18950−1461∗1−0.122∗ Mileage+0.012∗1∗ Mileage \\ &=(18950−1461∗1)+(−0.122+0.012∗1) Mileage \\ &=17489−0.11 Mileage \end{align}$$

*5 year old cars

$$\begin{align} \texttt{Price} &= 18950 − 1461 ∗ 5 − 0.122 ∗ \texttt{Mileage} + 0.012 ∗ 5 ∗ \texttt{Mileage} \\
 &=(18950 − 1461 ∗ 5) + (−0.122 + 0.012 ∗ 5) * \texttt{Mileage} \\
 &=11645 − 0.062 * Mileage \end{align}$$

*10 year old cars

$$\begin{align} \texttt{Price} &= 18950 − 1461 ∗ 10 − 0.122 ∗ \texttt{Mileage} + 0.012 ∗ 10 ∗ \texttt{Mileage} \\
 &=(18950 − 1461 ∗ 10) + (−0.122 + 0.012 ∗ 10) * \texttt{Mileage} \\
 &=4340 − 0.002 * Mileage \end{align}$$
 
 b. Notice that the intercepts of these 3 models (ages 1, 5, 10) differ. Which of the following options is the best interpretation of these differences?
* As the age of a car increases, the negative “impact” of mileage on price lessens.
* As the age of a car increases, the negative “impact” of mileage on price becomes greater.
* For cars with 0 mileage, average price increases as age increases.
* **For cars with 0 mileage, average price decreases as age increases.**

 c. As seen in the plot and equations in part a, the slopes of these 3 models also differ! Which of the following options is the best interpretation of these differences?
* **As the age of a car increases, the negative “impact” of mileage on price lessens.**
* As the age of a car increases, the negative “impact” of mileage on price becomes greater.
* For cars with 0 mileage, average price increases as age increases.
* For cars with 0 mileage, average price decreases as age increases.

 d. In light of your work above, explain what the positive sign on the interaction coefficient indicates about the interaction between the mileage and age of a car.
 
 The positive coefficient means that they are multicolinear, and both are negative contributers to the price of the car. In other words, in order to get an accurate price for the car, accounting only for both age and mileage would underestimate the value, so a little value needs to be added if the age and mileage are non-zero.

# 3. Politics
In 2002 John McCain and John Kerry proposed new auto standards that would have forced manufacturers to increase fuel economy. Carl Levin proposed an amendment to the proposal that would delay any required increase in fuel economy. Hence a YES vote on the Levin amendment was good news for manufacturers. Senators also received contributions from auto manufacturers in 2002. This begs the questions: Who received the most auto contributions? Did it differ by political affiliation? How, if at all, were senators’ votes tied to their political affiliations and received auto contributions? In order to answer these questions, we’ll use the data set senators:

```{r}
senators <- read.csv("http://www.macalester.edu/~ajohns24/data/Senate.csv")
# Define a variable Affirmed that is TRUE only if voted YES
senators %<>% mutate(Affirmed = Vote == 1)
```

The senators data contains the following measurements on each senator:

Variable    | Description
---------   | ---------------
`Vote`	    | 1  or 0 (YES / NO)
`AutoCont`	| dollars received from auto manufacturers
`Party`	    | `D` (Democrat) or `R` (Republican)
`others`	  | other variables indicate the senators’ names & states

 a. There are 100 senators, 2 from each state. Using dplyr() functions, find the following summary statistics:

 * the number of 2002 senators that were Democrats
```{r}
senators %>%
  filter(Party == "D") %>%
  count
```
 
 * the number of senators that voted for the amendment
```{r}
senators %>%
  filter(Affirmed) %>%
  count
```

 b. Construct and comment on a univariate visualization of the received contributions (AutoCont).
```{r}
senators %>%
  ggplot(aes(x = AutoCont)) +
  geom_histogram(bins = 30)
senators %>%
  ggplot(aes(fill = Affirmed, x = AutoCont)) +
  geom_histogram(bins = 30)
senators %>%
  ggplot(aes(color = Affirmed, y = AutoCont)) +
  geom_boxplot()
```
 

 c. There’s a clear outlier that received a lot of money from auto manufacturers. Use dplyr code (don’t simply scan the data by eye) to identify the senator, and the state they represent. Extra: If you’re familiar with the auto industry, comment on why this state affiliation might not surprise us.
 
``` {r}
senators %>%
  arrange(-AutoCont) %>%
  head(1) %>%
  select(LastName, FirstName, State)
```

Carl Levin was the senator who proposed the amendment, and Michigan is a huge state for auto manufacturing plants.

 d. Create `senators_sub`, a subset of the data that does not include this outlier. Confirm that the properties of your `senators_sub` data set match those below. **IMPORTANT: Use the `senators_sub` data for the remainder of the homework.**
 
```{r}
senators_sub <- senators %>%
  filter(AutoCont != max(AutoCont))

# It appears there is an extra variable? dim = 99 x 7 not 99 x 6
dim(senators_sub)

# The mean is correct!
senators_sub %>% 
  summarize(mean(AutoCont))
```
 
# 4. Contributions vs party affiliation
Let’s turn our attention to the relationship between the money senators received from auto manufacturers and their party affiliations.

 a. Construct and interpret a visualization of the relationship between `AutoCont` and `Party`. (Again, don’t forget to use `senators_sub`!!!!)

```{r}
senators_sub %>%
  ggplot(aes(fill = Party, x = AutoCont)) +
  geom_histogram(bins = 30)

senators_sub %>%
  ggplot(aes(color = Party, y = AutoCont)) +
  geom_boxplot()
```

 b. Calculate the average `AutoCont` received by each party.
```{r}
senators_sub %>%
  group_by(Party) %>%
  summarise(mean(AutoCont))
```
 
 c. Construct a model of `AutoCont` by `Party.` Include a model summary table.
 
```{r}
cont_vs_party_model <- lm(AutoCont ~ Party, data = senators_sub)
summary(cont_vs_party_model)$coef
```
 
 d. Interpret the `PartyR` coefficient.

If the party is Republican, then contribution tends to be about $10k higher than a democratic counterpart.
